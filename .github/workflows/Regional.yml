name: Minimal Regional Test

on:
  workflow_dispatch:
    inputs:
      test_type:
        description: 'Test to run'
        required: true
        default: 'smoke'
        type: choice
        options:
          - smoke
          - load
          - spike
          - stress

jobs:
  minimal-test:
    # Runs your test on two different runners at the same time
    strategy:
      matrix:
        runner: [ubuntu-latest, windows-latest]
    runs-on: ${{ matrix.runner }}

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup k6
        uses: grafana/setup-k6-action@v1

      - name: Run k6 and show output
        run: |
          # Safe way to use the input
          TEST_TYPE="${{ github.event.inputs.test_type }}"
          echo "ðŸš€ Running $TEST_TYPE test from ${{ matrix.runner }} runner..."
          echo "----------------------------------------"
          # Run your existing test. Change the path if yours is different.
          k6 run "tests/performance/$TEST_TYPE/dummyjson-$TEST_TYPE.js"
